'use client'

import type { StaticImageData } from 'next/image'

import { cn } from '@/utilities/ui'
import NextImage from 'next/image'
import React from 'react'

import type { Props as MediaProps } from '../types'

import { cssVariables } from '@/cssVariables'
import { getMediaUrl } from '@/utilities/getMediaUrl'

const { breakpoints } = cssVariables

// A base64 encoded image to use as a placeholder while the image is loading
const placeholderBlur =
  'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEBLAEsAAD/4QBWRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAAEsAAAAAQAAASwAAAAB/+0ALFBob3Rvc2hvcCAzLjAAOEJJTQQEAAAAAAAPHAFaAAMbJUccAQAAAgAEAP/hDIFodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvADw/eHBhY2tldCBiZWdpbj0n77u/JyBpZD0nVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkJz8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0nYWRvYmU6bnM6bWV0YS8nIHg6eG1wdGs9J0ltYWdlOjpFeGlmVG9vbCAxMC4xMCc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczp0aWZmPSdodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyc+CiAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICA8dGlmZjpYUmVzb2x1dGlvbj4zMDAvMTwvdGlmZjpYUmVzb2x1dGlvbj4KICA8dGlmZjpZUmVzb2x1dGlvbj4zMDAvMTwvdGlmZjpZUmVzb2x1dGlvbj4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6eG1wTU09J2h0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8nPgogIDx4bXBNTTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnN0b2NrOmZlM2RkZDBlLWNiZTYtNGYzZi04MGU1LTY3OWZkYzM2ZmI5YzwveG1wTU06RG9jdW1lbnRJRD4KICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjE5MGJjY2MyLTdmN2ItNDM4NC04NmZmLTg3NmJmODc5OGRhODwveG1wTU06SW5zdGFuY2VJRD4KIDwvcmRmOkRlc2NyaXB0aW9uPgo8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSd3Jz8+/9sAQwAFAwQEBAMFBAQEBQUFBgcMCAcHBwcPCwsJDBEPEhIRDxERExYcFxMUGhURERghGBodHR8fHxMXIiQiHiQcHh8e/9sAQwEFBQUHBgcOCAgOHhQRFB4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4e/8AAEQgBaAIcAwERAAIRAQMRAf/EABgAAQEBAQEAAAAAAAAAAAAAAAIBAwAH/8QAGxABAQEBAQEBAQAAAAAAAAAAAQACETFhIRL/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/xAAWEQEB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'
export const ImageMedia: React.FC<MediaProps> = (props) => {
  const {
    alt: altFromProps,
    fill,
    pictureClassName,
    imgClassName,
    priority,
    resource,
    size: sizeFromProps,
    src: srcFromProps,
    loading: loadingFromProps,
  } = props

  let width: number | undefined
  let height: number | undefined
  let alt = altFromProps
  let src: StaticImageData | string = srcFromProps || ''

  if (!src && resource && typeof resource === 'object') {
    const { alt: altFromResource, height: fullHeight, url, width: fullWidth } = resource

    width = fullWidth!
    height = fullHeight!
    alt = altFromResource || ''

    const cacheTag = resource.updatedAt

    src = getMediaUrl(url, cacheTag)
  }

  const loading = loadingFromProps || (!priority ? 'lazy' : undefined)

  // NOTE: this is used by the browser to determine which image to download at different screen sizes
  const sizes = sizeFromProps
    ? sizeFromProps
    : Object.entries(breakpoints)
        .map(([, value]) => `(max-width: ${value}px) ${value * 2}w`)
        .join(', ')

  return (
    <picture className={cn(pictureClassName)}>
      <NextImage
        alt={alt || ''}
        className={cn(imgClassName)}
        fill={fill}
        height={!fill ? height : undefined}
        placeholder="blur"
        blurDataURL={placeholderBlur}
        priority={priority}
        quality={100}
        loading={loading}
        sizes={sizes}
        src={src}
        width={!fill ? width : undefined}
      />
    </picture>
  )
}
